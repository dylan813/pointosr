# OSR Evaluation Configuration
# This config is specifically for evaluating the trained OSR system on the test dataset

# Inherit base configuration and model architecture
defaults: ['default.yaml', 'pointnext-s.yaml']

# Override mode for evaluation
mode: 'osr_eval'

# Point to the trained model
pretrained_path: '/home/cerlab/Documents/pointosr_ws/src/pointosr/pointosr/log/cfgs/cfgs-train-pointnext-s-ngpus1-seed42-20250815-201349-EQzi4mHSZGtqBnqjezgvDh/checkpoint/cfgs-train-pointnext-s-ngpus1-seed42-20250815-201349-EQzi4mHSZGtqBnqjezgvDh_ckpt_best.pth'

# Dataset configuration - inherit from default.yaml, add OSR-specific eval dataset
dataset:
  eval:
    NAME: HumanDataset
    data_dir: '/home/cerlab/Documents/data/pointosr/eval_human'
    split: test
    num_points: 2048

# OSR-specific overrides
val_batch_size: 16  # Smaller batch for evaluation
dataloader:
  num_workers: 4  # Fewer workers for evaluation

# OSR evaluation specific settings
osr_eval:
  eval_dataset: 'eval'  # Use the eval dataset configuration
  fusion_config_path: '/home/cerlab/Documents/data/osr/calibration/human_k4_fp_k2/fusion_config.json'
  stats_path: '/home/cerlab/Documents/data/osr/calibration/human_k4_fp_k2/stats.json'
  prototypes_path: '/home/cerlab/Documents/data/osr/prototypes/human_k4_fp_k2'
  results_dir: '/home/cerlab/Documents/data/osr/evaluation'

# OSR (open set recognition) settings
osr:
  target_tpr: 0.99              # Target True Positive Rate for ID samples
  K_H: 4                        # Number of human prototypes  
  K_F: 2                        # Number of false-positive prototypes
  fused_weights: [0.5, 0.5]     # Initial weights for [energy, cosine] fusion
  temperature_init: 1.0         # Initial temperature for calibration
  
  calibration_dir: '/home/cerlab/Documents/data/pointosr/human'
  splits_dir: '/home/cerlab/Documents/data/pointosr/dataset/splits'
  
  output_dirs:
    prototypes: 'osr/prototypes'
    calibration: 'osr/calibration' 
    metrics: 'osr/metrics'
    exports: 'model/exports'
    checkpoints: 'model/checkpoints'

# Disable wandb for evaluation
wandb:
  use_wandb: False

# OSR-specific overrides
log_dir: 'osr_evaluation'
print_freq: 50
launcher: 'none'  # Single GPU evaluation
